<div class="container">
<div class="main-menu">
	<% conferences, years, last_year = MainMenu.params %>

	<% if @conference %>
		<% active_year = @conference.year.name.to_i %>
		<% active_conference = @conference.name %>
	<% elsif @year %>
		<% active_year = @year.name.to_i %>
		<% active_conference = '' %>
	<% else %>
		<% active_year = last_year.name.to_i %>
		<% active_conference = '' %>
	<% end %>

	<ul class="conference-menu" id='conference_menu' years='<%= years.pluck(:name).map do |year| year.to_i end %>' active_year = "<%= active_year %>" last_year = "<%= last_year.name %>"	active_conference = "<%= active_conference %>" >

		<% years.each do |year| %>
			
			<% flag = Flag.new('image_path' => Flag::GREY) %>
			
			<li class="flag-year-image-container" id="flag-<%=year.name.to_s%>" 
				year='<%=year.name.to_s%>' >
				<%= image_tag(flag.image_path) %>
				<p class='flag-text'> <%= year.name %> </p> 
			</li>

			<% conferences.where(year: year).by_date_asc.each do |conference| %>

				<% flag = Flag.new('image_path' => Flag::GREY) %>	
				
				<% if can? :read, conference %>
					<li class="flag-image-container conference-<%= year.name.to_s %> 
						conference-flag <%= conference.published ? "" : "unpublished" %> "
						id="<%= conference.route %>" >
						<%= link_to(  image_tag(flag.image_path),
							about_conference_path(conference.route) )%>
						<div class='flag-text'> <%= link_to conference.name + " " + 
							conference.year.name.to_s, about_conference_path(
							conference.route) %> 
						</div>  
					</li>
				<% end %>
			<% end %>
		<% end %>
	</ul>
</div>